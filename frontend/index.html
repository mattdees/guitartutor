<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chord Progressions</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/theme.css">
    <link rel="stylesheet" href="css/forms.css">
    <link rel="stylesheet" href="css/chords.css">
    <link rel="stylesheet" href="css/piano.css">
    <link rel="stylesheet" href="css/playback.css">
    <link rel="stylesheet" href="css/sheet-music.css">
    <link rel="stylesheet" href="css/responsive.css">
    <script src="https://cdn.jsdelivr.net/npm/soundfont-player@0.12.0/dist/soundfont-player.min.js"></script>
    <script type="module" src="js/init.js"></script>
</head>
<body>
    <div class="container">
        <div class="guitar-icon" id="instrumentIcon">üé∏</div>
        <h1>Chord Progressions</h1>
        <p class="subtitle">Select an instrument and progression</p>

        <div class="selector-container">
            <select class="instrument-select" id="instrumentSelect" aria-label="Instrument"></select>
            <select class="progression-select" id="progressionSelect" aria-label="Chord progression">
                <option value="" disabled>Loading progressions‚Ä¶</option>
            </select>
            <button class="random-btn" onclick="showRandomProgression()" aria-label="Random progression">üé≤ Random</button>
        </div>

        <div class="progression-card">
            <div class="progression-header">
                <h2 class="progression-name" id="progressionName">Loading‚Ä¶</h2>
                <div class="key-row">
                    <span class="key-label">Key:</span>
                    <select class="key-select" id="keySelect" aria-label="Key">
                        <option value="C">C</option>
                        <option value="C#">C# / Db</option>
                        <option value="D">D</option>
                        <option value="D#">D# / Eb</option>
                        <option value="E">E</option>
                        <option value="F">F</option>
                        <option value="F#">F# / Gb</option>
                        <option value="G">G</option>
                        <option value="G#">G# / Ab</option>
                        <option value="A">A</option>
                        <option value="A#">A# / Bb</option>
                        <option value="B">B</option>
                    </select>
                </div>
                <div class="pos-row" id="positionRow" style="display:none;">
                    <span class="pos-label">Neck:</span>
                    <select class="pos-select" id="positionSelect" aria-label="Neck position">
                        <option value="0">Any position</option>
                        <option value="2">Open (1st fret)</option>
                        <option value="5">5th fret</option>
                        <option value="7">7th fret</option>
                        <option value="9">9th fret</option>
                        <option value="12">12th fret</option>
                    </select>
                </div>
            </div>
            <div class="chords-container" id="chordsContainer">
                <div class="loading-msg">Loading chord data‚Ä¶</div>
            </div>

            <p class="description" id="description"></p>
            <div class="songs-section" id="songsSection" style="margin-bottom: 25px;">
                <div class="songs-header" onclick="toggleSongsCollapse()" role="button" aria-expanded="true" tabindex="0">
                    <p class="songs-title">Featured in</p>
                    <span class="songs-toggle" id="songsToggle">‚ñº</span>
                </div>
                <div class="songs-list" id="songsList"></div>
            </div>

            <div class="playback-section" id="playbackSection">
                <div class="playback-controls-row">
                    <div class="playback-control">
                        <label class="playback-label" for="patternSelect">Pattern</label>
                        <select id="patternSelect" class="playback-select">
                            <optgroup label="Basic">
                                <option value="whole">Whole</option>
                                <option value="half">Half</option>
                                <option value="quarter" selected>Quarter</option>
                            </optgroup>
                            <optgroup label="Arpeggio">
                                <option value="arpeggio-up">Arpeggio ‚Üë</option>
                                <option value="arpeggio-down">Arpeggio ‚Üì</option>
                                <option value="travis-picking">Travis Picking</option>
                                <option value="alberti-bass">Alberti Bass</option>
                                <option value="triplet-arpeggio">Triplet Arp</option>
                            </optgroup>
                            <optgroup label="Genre">
                                <option value="boom-chick">Boom-chick</option>
                                <option value="pop-strum">Pop strum</option>
                                <option value="pop-stabs">Pop Stabs</option>
                                <option value="bossa-nova">Bossa Nova</option>
                                <option value="reggae-skank">Reggae Skank</option>
                                <option value="funk-16th">Funk 16th</option>
                                <option value="jazz-swing">Jazz Swing</option>
                                <option value="rock-8th">Rock 8th</option>
                            </optgroup>
                            <optgroup label="Song Styles">
                                <option value="let-it-be">Ballad (Let It Be)</option>
                                <option value="stand-by-me">50s Doo-Wop (Stand By Me)</option>
                                <option value="creep-arpeggio">Alt-Rock (Creep)</option>
                                <option value="twist-and-shout">Rock &amp; Roll (Twist &amp; Shout)</option>
                                <option value="blues-shuffle">Blues Shuffle</option>
                                <option value="sweet-home-alabama">Southern Rock (Sweet Home Alabama)</option>
                                <option value="stairway-arpeggio">Classic Arpeggio (Stairway)</option>
                                <option value="hotel-california">Spanish Arpeggio (Hotel)</option>
                                <option value="wonderwall-strum">Brit-Pop Strum (Wonderwall)</option>
                                <option value="blackbird-pick">Acoustic Pluck (Blackbird)</option>
                            </optgroup>
                            <optgroup label="Practice">
                                <option value="palm-mute-8th">Palm Mute 8ths</option>
                                <option value="off-beat-8th">Off-beat 8ths</option>
                                <option value="country-alt-bass">Country Alt-Bass</option>
                                <option value="pima-arpeggio">Fingerstyle PIMA</option>
                                <option value="four-on-the-floor">Four-on-the-floor</option>
                            </optgroup>
                        </select>
                    </div>
                    <div class="playback-control">
                        <label class="playback-label" for="octaveSelect">Octave</label>
                        <select id="octaveSelect" class="playback-select">
                            <option value="3">3</option>
                            <option value="4" selected>4</option>
                            <option value="5">5</option>
                        </select>
                    </div>
                    <div class="playback-control">
                        <label class="playback-label" for="toneSelect">Tone</label>
                        <select id="toneSelect" class="playback-select">
                            <optgroup label="Acoustic Guitars">
                                <option value="acoustic_guitar_nylon" selected>Nylon Guitar</option>
                                <option value="acoustic_guitar_steel">Steel Guitar</option>
                            </optgroup>
                            <optgroup label="Electric Guitars">
                                <option value="electric_guitar_clean">Electric Clean</option>
                                <option value="electric_guitar_jazz">Electric Jazz</option>
                                <option value="electric_guitar_muted">Electric Muted</option>
                                <option value="overdriven_guitar">Overdrive</option>
                                <option value="distortion_guitar">Distortion</option>
                            </optgroup>
                            <optgroup label="Pianos &amp; Organs">
                                <option value="acoustic_grand_piano">Grand Piano</option>
                                <option value="bright_acoustic_piano">Bright Piano</option>
                                <option value="electric_piano_1">Electric Piano</option>
                                <option value="church_organ">Church Organ</option>
                                <option value="drawbar_organ">Hammond Organ</option>
                                <option value="harpsichord">Harpsichord</option>
                            </optgroup>
                            <optgroup label="Folk &amp; World">
                                <option value="banjo">Banjo</option>
                                <option value="fiddle">Fiddle</option>
                                <option value="sitar">Sitar</option>
                                <option value="kalimba">Kalimba</option>
                                <option value="steel_drums">Steel Drums</option>
                            </optgroup>
                            <optgroup label="Bass">
                                <option value="acoustic_bass">Acoustic Bass</option>
                                <option value="electric_bass_finger">Electric Bass</option>
                                <option value="synth_bass_1">Synth Bass</option>
                            </optgroup>
                        </select>
                    </div>
                </div>
            </div>

            <div class="sheet-music-section" id="sheetMusicSection" role="status" aria-label="Sheet music" style="display:none">
                <div class="sheet-music-header">
                    <div class="sheet-music-title">Sheet Music</div>
                    <div class="playback-control">
                        <label class="playback-label" for="tempoSlider" style="font-size: 0.7rem;">Tempo</label>
                        <input type="range" id="tempoSlider" min="40" max="220" value="120" class="tempo-slider" style="width: 80px;" aria-label="Tempo">
                        <span id="tempoValue" class="tempo-value" style="font-size: 0.75rem;">120</span>
                    </div>
                </div>
                <div id="sheetMusicContainer"></div>
            </div>

            <div class="playback-controls-row" style="margin-top: 20px;">
                <button class="playback-btn" id="playBtn" onclick="togglePlayback()" aria-label="Play or stop">‚ñ∂ Play</button>
                <button class="playback-btn" id="loopBtn" onclick="toggleLooping()" aria-label="Toggle looping">üîÅ Loop: Off</button>
                <button class="playback-btn download-btn" onclick="downloadMidi()" aria-label="Download MIDI">‚¨á MIDI</button>
            </div>
        </div>

        <footer><p id="footer"></p></footer>
    </div>
</body>
</html>
